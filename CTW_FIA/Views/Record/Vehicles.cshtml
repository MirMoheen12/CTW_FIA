@{
    Layout = null;
}

<div class="row no-gutters" >
  <div class="col-md-12 grid-margin stretch-card">
    <div class="card">
      <div class="card-body">
       

        <form class="forms-sample">
        <fieldset class="border p-3">
          <legend class="float-none w-auto p-2" style="font-size: 12px">
            Vehicle Form
          </legend>

          
            <div class="form-group row">
              <label
                for="VehicleType"
                class="col-sm-2 col-form-label"
                style="font-size: 13px"
                >Vehicle Type</label
              >
              <div class="col-sm-10">
                <select id="vehicleTypeid" class="form-control">
                  <option value="" disabled selected>
                    Select the Vechicle Type
                  </option>
                  <option>Alto Car</option>
                  <option>Bicycle</option>
                  <option>Car</option>
                  <option>Carry van</option>
                  <option>Chinchi Rikshaw</option>
                  <option>Corolla</option>
                  <option>Donkey cart</option>
                  <option>Double Cab Pickup</option>
                  <option>FX-Car</option>
                  <option>Hiace Van</option>
                  <option>Honda CG-125</option>
                  <option>Jeep</option>
                  <option>Mini Hino Truck</option>
                  <option>Mini Truck</option>
                  <option>Motor Bike</option>
                  <option>Motor Car</option>
                  <option>Motor Cycle</option>
                  <option>Motor Cycle/Cycles</option>
                  <option>Motorbike</option>
                  <option>Motorcar</option>
                  <option>Motorcycle</option>
                  <option>Pajero</option>
                  <option>pick up</option>
                  <option>Pickup</option>
                  <option>Police Truck</option>
                  <option>Prado Jeep</option>
                  <option>Rickshaw</option>
                  <option>Suzuki</option>
                  <option>Suzuki Taxi</option>
                  <option>Taxi/Car Cab</option>
                  <option>Toyota</option>
                  <option>Toyota corolla</option>
                  <option>Taxi/Car Cab</option>
                  <option>Toyota Pick up</option>
                  <option>Toyota Vitz</option>
                  <option>Tractor Trolley</option>
                  <option>Truck</option>
                  <option>Van</option>
                  <option>Unknown</option>
                </select>
              </div>
            </div>
            <div class="form-group row">
              <label
                for="vehicleSubType"
                class="col-sm-2 col-form-label"
                style="font-size: 13px"
                >Vehicle Sub Type
              </label>
              <div class="col-sm-10">
                <input
                  type="text"
                  class="form-control"
                  id="vehicleSubType"
                  placeholder=""
                />
              </div>
            </div>

            <div class="form-group row">
              <label
                for="makeModel"
                class="col-sm-2 col-form-label"
                style="font-size: 13px"
                >Make Model
              </label>
              <div class="col-sm-10">
                <input
                  type="text"
                  class="form-control"
                  id="makeModel"
                  placeholder=""
                />
              </div>
            </div>
            <div class="form-group row">
              <label
                for="RegistrationNo"
                class="col-sm-2 col-form-label"
                style="font-size: 13px"
                >Registration No.</label
              >
              <div class="col-sm-10">
                <input
                  type="text"
                  class="form-control"
                  id="RegistrationNo"
                  placeholder=""
                />
              </div>
            </div>
            <div class="form-group row">
              <label
                for="ChassesNo"
                class="col-sm-2 col-form-label"
                style="font-size: 13px"
                >Chases No
              </label>
              <div class="col-sm-10">
                <input
                  type="text"
                  class="form-control"
                  id="ChessesNo"
                  placeholder=""
                />
              </div>
            </div>
            <div class="form-group row">
              <label
                for="Color"
                class="col-sm-2 col-form-label"
                style="font-size: 13px"
                >Color
              </label>
              <div class="col-sm-10">
                <input
                  type="text"
                  class="form-control"
                  id="VehicleColor"
                  placeholder=""
                />
              </div>
            </div>
            <div class="form-group row">
              <label
                for="Size"
                class="col-sm-2 col-form-label"
                style="font-size: 13px"
                >Size</label
              >
              <div class="col-sm-10">
                <input
                  type="text"
                  class="form-control"
                  id="VehicleSize"
                  placeholder=""
                />
              </div>
            </div>
            <div class="form-group row">
              <label
                for="deviceLocation "
                class="col-sm-2 col-form-label"
                style="font-size: 13px"
                >Device Location
              </label>
              <div class="col-sm-10">
                <input
                  type="text"
                  class="form-control"
                  id="deviceLocation"
                  placeholder=""
                />
              </div>
            </div>
          
        </fieldset>

        <fieldset class="border p-3">
          <br />
          <div class="form-group row">
            <label
              for="Remarks"
              class="col-sm-2 col-form-label"
              style="font-size: 13px"
              >Remarks</label
            >
            <div class="col-sm-10">
              <textarea
                class="form-control"
                id="VehicleRemarks"
                rows="4"
              ></textarea>
            </div>
          </div>
        </fieldset>
        <br />
        <button
          type="button"
          class="btn btn-primary mr-2"
          onClick="vehicleSubmit()">
          Save
        </button>
        <button class="btn btn-dark">Cancel</button>
        </form>
      </div>
    </div>
  </div>
  @*<div class="col-md-3 grid-margin stretch-card">
    <div class="card">
      <div class="card-body">
        <h4 class="card-title">Matched Records</h4>
        <p class="card-description">No data to display</p>
      </div>
    </div>
  </div>*@

</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script type="text/javascript">
         var vpage_name ="";
         var vparam_x ="";
         var vpage_status = "";
         $(document).ready(function () {
         const urlParams = new URLSearchParams(window.location.search);
         const param_x = urlParams.get('id');
         const page_status = urlParams.get('pageStatus');
         const page_name= urlParams.get('pageName');
         vpage_name=page_name;
         vparam_x=param_x;
         vpage_status=page_status;
         if(page_status == "u" && param_x != "" && page_name == "vehiclePreview")
            {
                  //alert(page_status +" " +param_x +" " +page_name);
                  ViewVehicleById(param_x);
            } 
         });

        function vehicleSubmit()
         {
            if(vpage_status == "u" && vparam_x != "" && vpage_name == "vehiclePreview")
            {
                UpdateVehicle();
            } 
            else
            {
               VehiclePost();
            }
         } 
        function ViewVehicleById(x)
          {
            var url = "/api/Vehicles/"+x;
            $.ajax({  
            type: "GET",  
            url: url,
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            success: function (response) {  
                  //alert(JSON.stringify(response));
                    $("#vehicleTypeid").val(response.VehicleType);
                    $("#vehicleSubType").val(response.VehicleSubType);
                    $("#makeModel").val(response.MakeModel);
                    $("#RegistrationNo").val(response.RegistrationNo);
                    $("#ChessesNo").val(response.ChasesNo);
                    $("#VehicleColor").val(response.Color);
                    $("#VehicleSize").val(response.size);
                    $("#deviceLocation").val(response.DeviceLocation);
                    $("#VehicleRemarks").val(response.memRemarks);
                    $("#CreatedOnId").val(response.CreatedOn);
                    $("#CreatedById").val(response.CreatedBy);
            },
            error: function (response) {  
                //alert("error");  
            }
             });         
          }
        function UpdateVehicle()
          {
                var strid=vparam_x;
                var vehicleType = $('#vehicleTypeid').val();       
                var vehicleSubType = $('#vehicleSubType').val();
                var makeModel = $('#makeModel').val(); 
                var RegistrationNo = $("#RegistrationNo").val();
                var ChessesNo = $("#ChessesNo").val();
                var VehicleColor = $("#VehicleColor").val();
                var VehicleSize = $("#VehicleSize").val();
                var deviceLocation = $("#deviceLocation").val();
                var VehicleRemarks = $("#VehicleRemarks").val();

                  var settings = {
                  "url": "/api/Vehicles/"+strid,
                  "method": "Put",
                  "timeout": 0,
                  "headers": {
                    "Content-Type": "application/json"
                  },
                  "data": JSON.stringify({
                    "intID": 0,
                    "strURN": strid,
                    "vehicleType": vehicleType,
                    "vehicleSubType": vehicleSubType,
                    "makeModel": makeModel,
                    "registrationNo": RegistrationNo,
                    "chasesNo": ChessesNo,
                    "color": VehicleColor,
                    "size": VehicleSize,
                    "deviceLocation": deviceLocation,
                    "memRemarks": VehicleRemarks,
                    "createdBy": "string",
                    "dteSent": "2022-04-04T03:56:30.575Z",
                    "lastModifiedBy": "string"
                  }),
                };

            $.ajax(settings).done(function (response) {
             alert("Vehicle has been updated successfully");
            // window.location.href = "https://localhost:44313/Admin/Records/PreviewVehicleRecord?id="+strid;
      window.location.href = "/Admin/Records/PreviewRecord?controller=Vehicles&id="+strid;
         
            });
    }
        function VehiclePost(){

              var vehicleType = $('#vehicleTypeid').val();       
              var vehicleSubType = $('#vehicleSubType').val();
              var makeModel = $('#makeModel').val(); 
              var RegistrationNo = $("#RegistrationNo").val();
              var ChessesNo = $("#ChessesNo").val();
              var VehicleColor = $("#VehicleColor").val();
              var VehicleSize = $("#VehicleSize").val();
              var deviceLocation = $("#deviceLocation").val();
              var VehicleRemarks = $("#VehicleRemarks").val();
              var settings = {
              "url": "/api/Vehicles",
              "method": "POST",
              "timeout": 0,
              "headers": {
                "Content-Type": "application/json"
              },
              "data": JSON.stringify({
                "intID": 0,
                "strURN": "string",
                "vehicleType": vehicleType,
                "vehicleSubType": vehicleSubType,
                "makeModel": makeModel,
                "registrationNo": RegistrationNo,
                "chasesNo": ChessesNo,
                "color": VehicleColor,
                "size": VehicleSize,
                "deviceLocation": deviceLocation,
                "memRemarks": VehicleRemarks,
                "createdBy": "string",
                "dteSent": "2022-04-04T03:56:30.575Z",
                "lastModifiedBy": "string"
              }),
            };

            $.ajax(settings).done(function (response) {
              alert("Vehicle has been added successfully");
                   if (confirm('Do you want to add Media File ?')) {
                       console.log("Media File.");
                       localStorage.setItem("strURN", response.strURN);
                       localStorage.setItem("tableName", "Vehicle");
                       window.location.href = "/Admin/Records/AddMedia";
                   }
                   else
                   {
                       var id=response.strURN;
                      // window.location.href = "https://localhost:44313/Admin/Records/PreviewVehicleRecord?id="+id;
                   window.location.href = "/Admin/Records/PreviewRecord?controller=Vehicles&id="+id;
         
                   }
                 });
           }

</script>
