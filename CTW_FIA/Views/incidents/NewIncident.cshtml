@model CTW_FIA.Models.DatabaseModels.Incident
@{
 
}

<div class="row no-gutters" style="">

            <div class="col-md-12 grid-margin stretch-card">
                <div class="card">
                    <div class="card-body">

                        <h5>Main Incident</h5>
                  
                       <form class="forms-sample" method="post" asp-action="NewIncident" asp-controller="Records">
                            <div class="form-group row">

                                <label for="OperationName" class="col-sm-2 col-form-label" style="font-size: 13px;">Subject</label>
                                <div class="col-sm-10">
                            <input type="text" class="form-control" id="OperationName" asp-for="strOperationName" name="OperationName">
                                </div>
                            </div>
                            <div class="form-group row">


                                <label for="FirString" class="col-sm-2 col-form-label" style="font-size: 13px;">FIR # </label>
                                <div class="col-sm-10">
                                    <label type="text" class="col-form-label"  id="FirString"></label>
                                </div>
                            </div>
                            <fieldset class="border p-3">

                                <legend class="float-none w-auto p-2" style="font-size:12px">FIR Details </legend>
                                <div class="form-group row">

                                    <label for="FirNo" class="col-sm-2 col-form-label" style="font-size: 13px;">FIR No </label>
                                    <div class="col-sm-10">
                                <input type="text" class="form-control" asp-for="FirNo" id="FirNo" />
                                    </div>
                                </div>

                              
                                <div class="form-group row"> 
                                 <label for="Description" class="col-sm-2 col-form-label" style="font-size: 13px;">Reg Year</label>
                                    <div class="col-sm-4">
                                        <input type="number" class="form-control" asp-for="RegYear" id="RegYear"/>
                                    </div>


                                    <label for="Police" class="col-sm-2 col-form-label" style="font-size: 13px;">U/S</label>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" asp-for="US" id="US" />
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="IncidentCountryList" class="col-sm-2 col-form-label"  style="font-size: 13px;">Country</label>
                                       <div class="col-sm-4">
                                <select  asp-for="Country" id="selectedcountry" class="form-control">
                                    <option>Select Country</option>
                                    @for (var i = 0; i < ViewBag.country.Count; i++)
                                    {
                                        <option>@ViewBag.country[i].Country</option>
                                    }
                                        </select>
                                </div>

                                    <label for="IncidentProvinceList" class="col-sm-2 col-form-label" style="font-size: 13px;">Province </label>
                                    <div class="col-sm-4">
                         <select id="personprovince" asp-for="Province" class="form-control">
                                           <option>Select the Province</option>
                                    </select>
                                    </div>
                                </div>
                                
                                <div class="form-group row">
                                    
                                    <label for="IncidentDistrictList" class="col-sm-2 col-form-label" style="font-size: 13px;">District</label>
                                    <div class="col-sm-4">
                                 
                                    <select onchange="LoadPolice()" asp-for="District" id="SelectDistrict" class="form-control">
                                        <option>Select the District</option>
                                           
                                        </select>
                                    </div>

                                                                
                                </div>
                                 <div class="form-group row">
                                    <label for="PoliceStation" class="col-sm-2 col-form-label" style="font-size: 13px;">Police Station</label>

                                    <div class="col-sm-4">
                         
                                   <select class="form-control" id="PoliceStation" asp-for="PoliceStation" onchange="selectPolice()">
                                            <option>Select Police Station</option>
                                        </select>
                                    </div>

                                    <div class="col-sm-2">

                                        @*<button class="btn btn-primary mr-2" style="font-size: 11px;" >Add</button>*@

                                    </div>

                                </div>
                                <div class="form-group row">
                                     
                                <label for="IncidentPostalZip" class="col-sm-2 col-form-label" style="font-size: 13px;">Postal Zip</label>
                                     
                                    <div class="col-sm-4">
                                          <input type="text" asp-for="PostalZip"  id="IncidentPostalZip" class="form-control" />
                                    </div>
                                </div>
                                  <div class="form-group row">
                                     
                                <label for="IncidentPostalZip" class="col-sm-2 col-form-label" style="font-size: 13px;">Longitude</label>
                                     
                                    <div class="col-sm-4">
                                <input type="text" id="IncidentLongitude" asp-for="Longitude" class="form-control" />
                                    </div>
                                     <label for="IncidentPostalZip" class="col-sm-2 col-form-label" style="font-size: 13px;">Latitude</label>
                                     
                                    <div class="col-sm-4">
                                <input type="text" asp-for="Latitude" id="IncidentLatitude" class="form-control" />
                                    </div>
                                </div>
                              
                                
                               
                                <div class="form-group row">

                                    <label for="IncidentAddress" class="col-sm-2 col-form-label" style="font-size: 13px;">Address</label>
                                    <div class="col-sm-10">
                                <textarea class="form-control" asp-for="Address" id="IncidentAddress" rows="4"></textarea>

                                    </div>
                                </div>
                              
                            </fieldset>

                        <fieldset class="border p-3">
                            <legend class="float-none w-auto p-2" style="font-size: 12px">Incident Details</legend>

                            <div class="form-group row">
                                <label for="IncidentDate" class="col-sm-2 col-form-label" style="font-size: 13px;">Incident Date</label>

                                <div class="col-sm-4">

                                    <input type="date" asp-for="IncidentDate" class="form-control" id="IncidentDate"/>

                                    </div>
                            </div>
                            <div class="form-group row">
                                <label for="IncidentTime" class="col-sm-2 col-form-label" style="font-size: 13px;">Incident Time</label>

                                <div class="col-sm-4">

                                <input type="time" asp-for="IncidentTime" class="form-control" id="IncidentTime" />

                                </div>
                                <label for="IncidentTimeEnd" class="col-sm-2 col-form-label" style="font-size: 13px;">Incident End Time</label>
                                
                            <div class="col-sm-4">
                                <input type="time" asp-for="IncidentTimeEnd" class="form-control" id="IncidentTimeEnd" />

                               
                            </div>
                              
                            </div>
                            <div class="form-group row">
                            <label for="PreIncidentThread" class="col-sm-2 col-form-label" style="font-size: 13px;">Pre Incident Threat </label>
                                    <div class="col-sm-4">
                                     <select class="form-control" asp-for="PreIncidentThread" id="PreIncidentThread">
                                            <option value="" disabled selected>Select</option>
                                           <option value="EMAIL">EMAIL</option>
                                           <option value="OTHER">OTHER</option>
                                           <option value="TELEPHONE">TELEPHONE</option>
                                           <option value="WRITTEN NOTE">WRITTEN NOTE</option>
                                    
                                        </select>
                                    </div>
                          </div>

                        </fieldset>

                        <fieldset class="border p-3">
                            <legend class="float-none w-auto p-2" style="font-size: 12px">Casualties</legend>

                            <div class="form-group row">

                                <label for="Killed" class="col-sm-2 col-form-label" style="font-size: 13px;">Number Killed</label>

                                <div class="col-sm-4">

                                <input type="number" asp-for="NumberKilled" class="form-control" id="NumberKilled" />

                                </div>
                               
                               @* <label for="NumberInjured" class="col-sm-2 col-form-label" style="font-size: 13px;">Number Injured</label>
                                <div class="col-sm-4">
                                     <input type="number"  class="form-control"  id="NumberInjured"/>

                                </div>*@
                            </div>
                                <div class="form-group row">
                               
                                <label for="KilledNames" class="col-sm-2 col-form-label" style="font-size: 13px;">Names of Killed Person</label>
                                <div class="col-sm-10">
                                     @*<input type="text"  class="form-control"  id="KilledNames"/>*@
                                <textarea class="form-control" asp-for="CasualtiesNames" id="KilledNames" rows="4"></textarea>

                                </div>
                            </div>
                            <div class="form-group row">

                               
                                <label for="NumberInjured" class="col-sm-2 col-form-label" style="font-size: 13px;">Number Injured</label>
                                <div class="col-sm-4">
                                <input type="number" asp-for="NumberInjured" class="form-control" id="NumberInjured" />

                                </div>
                            </div>
                            <div class="form-group row">
                            
                                <label for="InjuredName" class="col-sm-2 col-form-label" style="font-size: 13px;">Names of Injured Person</label>
                                <div class="col-sm-10">
                                   @*  <input type="text"  class="form-control" id="InjuredName" />*@
                                       <textarea  class="form-control" asp-for="InjuredName" id="InjuredName" rows="4"></textarea>

                                </div>
                            </div>
                         
                           
                        </fieldset>
                        <fieldset class="border p-3">
                            <legend class="float-none w-auto p-2" style="font-size: 12px;"> </legend>
                            <div class="form-group row">
                                <label for="Weapon" class="col-sm-2 col-form-label" style="font-size: 13px;">Weapon</label>
                                 <div class="col-sm-2">
                                <select class="form-control" asp-for="Weapon" id="Weapon">
                                        <option value="" disabled selected>Select</option>
                                        <option>Automatic Weapon</option>
                                        <option>Hand Grenade</option>
                                        <option>IED</option>
                                        <option>Inflammable</option>
                                        <option>Landmine</option>
                                        <option>Mortar</option>
                                        <option>Multiple Weapons</option>
                                        <option>Planted Bomb</option>
                                        <option>Remote Control IED</option>
                                        <option>Rocket</option>
                                        <option>RPG</option>
                                         <option>Multiple Weapons Assault</option>
                                         <option>HBIED</option>
                                          <option>VBIED</option>
                                         @* <option>Suicide Bomber</option>*@
                                         <option>Time Bomb</option>
                                         <option>Other</option>
                                 
                                    </select>
                                </div>
                                  <div class="col-sm-1"></div>
                                  <label for="IncidentTarget" class="col-sm-1 col-form-label" style="font-size: 13px;">Target</label>
                               
                                 <div class="col-sm-2">
                                <select class="form-control" asp-for="Target" id="IncidentTarget">
                                        <option value="" disabled selected>Select</option>
                                        <option>Airport/Aeroplane</option>
                                        <option>Bridge/Road</option>
                                        <option>Educational Institution</option>
                                        <option>Electric Tower</option>
                                        <option>Ethnic (Punjabi)</option>
                                        <option>FC/security Force</option>
                                        <option>FC/Security</option>
                                        <option>Foreign Diplomat</option>
                                        <option>Gas Pipeline</option>
                                        <option>Gen. Public</option>
                                        <option>Govt Employee</option>
                                        <option>Govt Office/Building</option>
                                        <option>Govt Vehicle</option>
                                        <option>Intelligence Depts</option>
                                        <option>Minority (Christains)</option>
                                        <option>Minority (Hindus)</option>
                                        <option>Minority (Others)</option>
                                        <option>Minority (Qadianis)</option>
                                         <option>Minority (Sikhs)</option>
                                        <option>Multi-National/Foreign Mission</option>
                                         <option>NATO</option>
                                        <option>NGO</option>                                   
                                        <option>Police</option>
                                        <option>Police Station/Check Post</option>
                                        <option>Public Place</option>
                                         <option>Public Property</option>
                                        <option>Railway Track/Train</option>
                                         <option>Religious Leader</option>
                                        <option>Sectarian (Shia Sect)</option>
                                          <option>Sectarian (Sunni Sect)</option>
                                        <option>Telephone Tower</option>
                                         <option>TV Booster/Radio Station</option>
                                        <option>Water Utility</option>
                                         <option>Other</option>
                                    </select>
                                </div>
                          @*  </div>
                              <div class="form-group row">*@  <div class="col-sm-1"></div>
                                <label for="Motive" class="col-sm-1 col-form-label" style="font-size: 13px;">Motive </label>
                                
                                <div class="col-sm-2">
                                
                                   <select class="form-control" asp-for="Motive"  id="Motive">
                                        <option value="" disabled selected>Select</option>
                                        <option>Ethinic</option>
                                        <option>Religious Millitants</option>
                                        <option>Sectarian</option>
                                        <option>Sub Nationalist</option>
                                        <option>Unknown</option>
                                        
                                    </select>
                                </div>
                           </div>
                         <div class="form-group row">
                                
                                <label for="ModusofOperandi" class="col-sm-2 col-form-label" style="font-size: 13px;">Modus operandi</label>
                                <div class="col-sm-10">
                                   
                                    <textarea  class="form-control" asp-for="ModusofOperand" id="ModusofOperandi" rows="4"></textarea>

                                </div>
                            </div>
                        </fieldset>

                        <fieldset class="border p-3">
                            <legend class="float-none w-auto p-2" style="font-size: 12px;">Case Details and Progress</legend>

                             <div class="form-group row">
                                 
    
                                <label for="CrimeSceneRecoveries" class="col-sm-2 col-form-label" style="font-size: 13px;">Recoveries from Crime Scene Premises</label>
                                <div class="col-sm-10">
                                     <input type="text" asp-for="CrimeSceneRecoveries" id="CrimeSceneRecoveries" class="form-control" />
                                </div>
                            </div>
                            <div class="form-group row">

                                <label for="Recoveries" class="col-sm-2 col-form-label" style="font-size: 13px;">Recoveries</label>
                                <div class="col-sm-10">
                                   <input type="text" asp-for="Recoveries"  id="Recoveries" class="form-control" />
                                </div>
                            </div>
                            @* <div class="form-group row">
                                 
    
                                <label for="CrimeSceneRecoveries" class="col-sm-2 col-form-label" style="font-size: 13px;">Recoveries after Incident</label>
                                <div class="col-sm-10">
                                     <input type="text" id="RecoveriesafterIncident" class="form-control" />
                                </div>
                            </div>*@
                            <div class="form-group row">
                                
                                <label for="CaseProgress" class="col-sm-2 col-form-label" style="font-size: 13px;">Case Progress</label>
                                <div class="col-sm-10">
                                <input type="text" asp-for="strCaseProgress" id="CaseProgress" class="form-control" />
                                </div>
                            </div>

                            <div class="form-group row">
                                
                                <label for="NumberArrested" class="col-sm-2 col-form-label" style="font-size: 13px;">Number Arrested</label>
                                <div class="col-sm-4">   
                                    <input type="number" asp-for="NumberArrested" class="form-control" id="NumberArrested" placeholder="" >
                                </div>
                                 <label for="Reportedby" class="col-sm-2 col-form-label" style="font-size: 13px;">Reported by </label>
                                
                                <div class="col-sm-4">

                                <select class="form-control" asp-for="Reportedby" id="Reportedby">
                                     
                                        
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row">
                                
                                <label for="CaseStatus" class="col-sm-2 col-form-label" style="font-size: 13px;">Description</label>
                                <div class="col-sm-10">
                                   
                                     <textarea class="form-control" id="CaseStatus" asp-for="CaseStatus" rows="4"></textarea>
                                </div>

                            </div>
                             
                        </fieldset>
                        <fieldset class="border p-3">
                            
                            <br>
                           @*  <div class="form-group row">
                                <label for="RoleOfCTW" class="col-sm-2 col-form-label" style="font-size: 13px;">Role of CTW</label>

                                <div class="col-sm-10">
                                     <input type="text" id"RoleOfCTW" class="form-control" />
                                </div>
                            </div>*@
                            <div class="form-group row">
                                
                                <label for="IncidentmemRemarks" class="col-sm-2 col-form-label" style="font-size: 13px">CTW Remarks</label>
                                <div class="col-sm-10">
                                <textarea asp-for="CTWRemarks" class="form-control" id="IncidentmemRemarks" rows="4"></textarea>

                                </div>
                            </div>

                        </fieldset>

                        <br>
                    <input type="text" id="asgstr" hidden asp-for="strURN" />
                        <input type="submit" id="IncidentBtn"  class="btn btn-primary mr-2" value="Save">
                        <button class="btn btn-dark">Cancel</button>
                        </form>

                    </div>
                </div>
            </div>
            @*<div class="col-md-3 grid-margin stretch-card">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">Selected Records</h4>
                        <p class="card-description" style="font-size: 12px;"> No data found </p>


                    </div>

                </div>
            </div>*@
        </div>

<script type="text/javascript">
      var vpage_name ="";
      var vparam_x ="";
      var vpage_status = "";
      var FirString="";
      var ProvinceList= [];
     $(document).ready(function () {
        const urlParams = new URLSearchParams(window.location.search);
         const param_x = urlParams.get('id');
         const page_status = urlParams.get('pageStatus');
         const page_name= urlParams.get('pageName');
         vpage_name=page_name;
         vparam_x=param_x;
         $('#asgstr').val(vparam_x);
         vpage_status=page_status;

             LoadIncidentProvince();
             LoadReportingAgency();
      //  var FirString = $('#FirString').val(); 
         $('#FirString').html(""); 
           if(page_status == "u" && param_x != "" && page_name == "PreviewIncidentRecord")
            {
               
                ViewIncidentById(param_x);
            }
           else
           {
            
           }
    });
  
    $("#FirNo").keyup(function(){
   
      $('#FirString').html(""); 
        FirString="";
        FirString = "FIR#" + $('#FirNo').val(); 
        FirString = FirString +"/"+ $('#RegYear').val()+" "; 
        FirString = FirString +"U/S:"+ $('#US').val()+" "; 
        FirString = FirString +"P.S:"+ $('#PoliceStation').val()+" ,"; 
        FirString = FirString +"District:"+ $('#IncidentDistrictList').val()+" "; 
        $('#FirString').html(FirString); 
  });
    $("#RegYear").keyup(function(){
   
      $('#FirString').html(""); 
           //  FirString="";
      //  FirString = $('#FirNo').val(); 
      //FirString = FirString + $('#RegYear').val(); 
      //FirString = FirString + $('#US').val(); 
        FirString="";
        //var ps= $('#IncidentPoliceStation').val();
        //var d=$('#IncidentDistrictList').val();
          FirString = "FIR#" + $('#FirNo').val(); 
        FirString = FirString +"/"+ $('#RegYear').val()+" "; 
        FirString = FirString +"U/S:"+ $('#US').val()+" "; 
        FirString = FirString +"P.S:"+ $('#PoliceStation').val()+" ,"; 

        FirString = FirString +"District:"+ $('#IncidentDistrictList').val()+" "; 
        $('#FirString').html(FirString); 
        //$('#FirString').html(FirString); 
  });
    $("#US").keyup(function(){
   
      //$('#FirString').html(""); 
      //       FirString="";
      //  FirString = $('#FirNo').val(); 
      //FirString = FirString + $('#RegYear').val(); 
      //FirString = FirString + $('#US').val(); 
        
      //  $('#FirString').html(FirString); 
         FirString="";
          FirString = "FIR#" + $('#FirNo').val(); 
        FirString = FirString +"/"+ $('#RegYear').val()+" "; 
        FirString = FirString +"U/S:"+ $('#US').val()+" "; 
        FirString = FirString +"P.S:"+ $('#PoliceStation').val()+" ,"; 
        FirString = FirString +"District:"+ $('#IncidentDistrictList').val()+" "; 
        $('#FirString').html(FirString); 
  });
 
  function selectdistrict()
  {
      // alert("d");
         FirString="";
          FirString = "FIR#" + $('#FirNo').val(); 
        FirString = FirString +"/"+ $('#RegYear').val()+" "; 
        FirString = FirString +"U/S:"+ $('#US').val()+" "; 
        FirString = FirString +"P.S:"+ $('#PoliceStation').val()+" ,"; 
        FirString = FirString +"District:"+ $('#IncidentDistrictList').val()+" "; 
        $('#FirString').html(FirString); 
  }
  function selectPolice()
  {
      // alert("p");
         FirString="";
          FirString = "FIR#" + $('#FirNo').val(); 
        FirString = FirString +"/"+ $('#RegYear').val()+" "; 
        FirString = FirString +"U/S:"+ $('#US').val()+" "; 
        FirString = FirString +"P.S:"+ $('#PoliceStation').val()+" ,"; 
        FirString = FirString +"District:"+ $('#SelectDistrict').val()+" "; 
        $('#FirString').html(FirString); 
  }
  //  $("#IncidentDistrictList").onChange(function(){
  // alert("d");
  //       FirString="";
  //        FirString = "FIR#" + $('#FirNo').val(); 
  //      FirString = FirString +"/"+ $('#RegYear').val()+" "; 
  //      FirString = FirString +"U/S:"+ $('#US').val()+" "; 
  //      FirString = FirString +"P.S:"+ $('#PoliceStation').val()+" ,"; 
  //      FirString = FirString +"District:"+ $('#IncidentDistrictList').val()+" "; 
  //      $('#FirString').html(FirString); 
  //});
      function IncidentClick()
         {
            if(vpage_status == "u" && vparam_x != "" && vpage_name == "PreviewIncidentRecord")
            {
                IncidentUpdation();
               
            } 
            else
            {
               IncidentInsertion();
            }
            
      }

    //$("#incident_form").validate({
    //    rules: {
    //        OperationName: "required"
    //    },
    //    messages: {
    //        OperationName: "Please Fill Subject Name"
    //    },
    //    submitHandler: function (form) {
    //        // your ajax would go here.

    //        alert("Form Submit Successfully");
    //        IncidentInsertion();
    //        return false; // extra insurance preventing the default form action
    //    }
    //});

    function IncidentInsertion()
    {
        var FirNo = "";
        var RegYear=0;
        var US="";
        var OperationName = "";
        var IncidentCountryList ="Pakistan";
        var IncidentCity="";
        var IncidentProvinceList="";
        var IncidentDistrictList="";
        var IncidentPostalZip="";
        var IncidentPoliceStation="";
        var numberKilled="";
        var numberInjured ="";
        var InjuredName="";
        var KilledNames ="";
        var Target="";
        var Motive ="";
        var weapon="";
        var Recoveries ="";
        var CrimeSceneRecoveries ="";
        var caseStatus ="";
        var CTWRemarks ="";
        var NumberArrested ="";
        var PreIncidentThread ="";
        var Reportedby ="";
        var CTWRemarks ="";
         var IncidentLatitude ="";
        var IncidentLongitude ="";
          
          FirNo = $('#FirNo').val();
      //  alert(FirNo);
          RegYear = $('#RegYear').val(); 
          US = $('#US').val(); 
          OperationName = $('#OperationName').val();
          IncidentCountryList = "Pakistan";   
          IncidentCity = $('#IncidentCity').val(); 
          IncidentProvinceList = $('#IncidentProvinceList').val(); 
          IncidentDistrictList = $('#IncidentDistrictList').val(); 
          IncidentPostalZip = $('#IncidentPostalZip').val(); 
          IncidentPoliceStation = $('#PoliceStation').val(); 
          IncidentAddress = $('#IncidentAddress').val();  
          numberKilled = $('#NumberKilled').val(); 
          numberInjured = $('#NumberInjured').val(); 
          InjuredName = $('#InjuredName').val(); 
          KilledNames = $('#KilledNames').val(); 
          Target = $('#IncidentTarget').val(); 
          Motive = $('#Motive').val();
          weapon = $('#Weapon').val();
          Recoveries = $('#Recoveries').val();
          crimeSceneRecoveries = $('#CrimeSceneRecoveries').val();
          caseStatus = $('#CaseStatus').val();
          CaseProgress = $('#CaseProgress').val();
          NumberArrested = $('#NumberArrested').val();
          PreIncidentThread = $('#PreIncidentThread').val();
          Reportedby = $('#Reportedby').val();
          CTWRemarks = $('#IncidentmemRemarks').val();
          
          IncidentLatitude = $('#IncidentLatitude').val();
          IncidentLongitude = $('#IncidentLongitude').val();
                                 
          var settings = {
                  "url": "/api/Incidents",
                  "method": "POST",
                  "timeout": 0,
                  "headers": {
                    "Content-Type": "application/json"
                  },
              "data": JSON.stringify({
                "intID": 0,
                "strURN": "stri12",
                "strOperationName": OperationName,
                "firNo": FirNo,
                "regYear": RegYear,
                "US": US,
                "country": IncidentCountryList,
                "province": IncidentProvinceList,
                "city": IncidentCity,
                "district": IncidentDistrictList,
                "postalZip": IncidentPostalZip,
                "policeStation": IncidentPoliceStation,
                "address": IncidentAddress,
                //"incidentDate": IncidentDate,
                //"incidentTime": IncidentTime,
                //"incidentTimeEnd": IncidentTimeEnd,
                "incidentDate": "2022-04-01T07:13:36.415Z",
                "incidentTime": "2022-04-01T07:13:36.415Z",
                "incidentTimeEnd": "2022-04-01T07:13:36.415Z",
                "dateSent": "2022-04-01T07:13:36.415Z",
                "latitude":  IncidentLongitude,
                "longitude": IncidentLatitude,
                "NumberKilled":numberKilled,
                "NumberInjured": numberInjured,
                "InjuredName": InjuredName,
                "CasualtiesNames": KilledNames,
                "Weapon": weapon,
                "Target": Target,
                "Motive": Motive,
                "Recoveries": Recoveries,
                "PreIncidentThread": PreIncidentThread,
                "CrimeSceneRecoveries": crimeSceneRecoveries,
                "CaseStatus": caseStatus,
                "NumberArrested": NumberArrested,
                "Reportedby": Reportedby,
                "strCaseProgress": CaseProgress,
                "CTWRemarks": CTWRemarks,
                "createdBy": "admin",
                "UpdatedBy": "admin",
                "IsDeleted":false
              }), 
            };
            $.ajax(settings).done(function (response) {
              console.log(response);
              alert("Incident has been added Successfully");

              if (confirm('Do you want to add Media File ?')) {
                 
                   console.log("Media File.");
                   localStorage.setItem("strURN", response.strURN);
                   localStorage.setItem("tableName", "Incident");
                   window.location.href = "/Admin/Records/AddMedia";
              }
              else
              {
                    
                 //var id=response.strURN;
                   localStorage.setItem("strURN", response.strURN);
                   localStorage.setItem("tableName", "Incident");
                //   window.location.href = "/Admin/Records/AddMedia";
                 var id=response.strURN;
                  // window.location.href = "/Admin/Records/PreviewIncidentRecord?id="+id;
                   window.location.href = "/Admin/Records/PreviewRecord?controller=Incidents&id="+id;
         
              }
             });
    }
  

      function IncidentUpdation()
      {
       var stdId=vparam_x;
       var FirNo = "";
       var RegYear=0;
       var US="";
       var OperationName = "";
       var IncidentCountryList ="Pakistan";
       var IncidentCity="";
       var IncidentProvinceList="";
       var IncidentDistrictList="";
       var IncidentPostalZip="";
       var IncidentPoliceStation="";
       var numberKilled="";
       var numberInjured ="";
       var InjuredName="";
       var KilledNames ="";
       var Target="";
       var Motive ="";
       var weapon="";
       var Recoveries ="";
       var CrimeSceneRecoveries ="";
       var caseStatus ="";
       var CTWRemarks ="";
       var NumberArrested ="";
       var PreIncidentThread ="";
       var Reportedby ="";
       var IncidentLatitude ="";
       var IncidentLongitude ="";   
          
          FirNo = $('#FirNo').val();
          //  alert(FirNo);
          RegYear = $('#RegYear').val(); 
          US = $('#US').val(); 
          OperationName = $('#OperationName').val();
          IncidentCountryList = "Pakistan";   
          IncidentCity = $('#IncidentCity').val(); 
          IncidentProvinceList = $('#IncidentProvinceList').val(); 
          IncidentDistrictList = $('#IncidentDistrictList').val(); 
          IncidentPostalZip = $('#IncidentPostalZip').val(); 
          IncidentPoliceStation = $('#PoliceStation').val(); 
          IncidentAddress = $('#IncidentAddress').val();  
          numberKilled = $('#NumberKilled').val(); 
          numberInjured = $('#NumberInjured').val(); 
          InjuredName = $('#InjuredName').val(); 
          KilledNames = $('#KilledNames').val(); 
          Target = $('#IncidentTarget').val(); 
          Motive = $('#Motive').val();
          weapon = $('#Weapon').val();
          Recoveries = $('#Recoveries').val();
          crimeSceneRecoveries = $('#CrimeSceneRecoveries').val();
          caseStatus = $('#CaseStatus').val();
          CaseProgress = $('#CaseProgress').val();
          NumberArrested = $('#NumberArrested').val();
          PreIncidentThread = $('#PreIncidentThread').val();
          Reportedby = $('#Reportedby').val();
          CTWRemarks = $('#IncidentmemRemarks').val();
          IncidentLatitude = $('#IncidentLatitude').val();
          IncidentLongitude = $('#IncidentLongitude').val();
                                 
         var settings = {
                  "url": "/api/Incidents/"+stdId,
                  "method": "Put",
                  "timeout": 0,
                  "headers": {
                    "Content-Type": "application/json"
                  },
              "data": JSON.stringify({
                "intID": 0,
                "strURN": stdId,
                "strOperationName": OperationName,
                "firNo": FirNo,
                "regYear": RegYear,
                "US": US,
                "country": IncidentCountryList,
                "province": IncidentProvinceList,
                "city": IncidentCity,
                "district": IncidentDistrictList,
                "postalZip": IncidentPostalZip,
                "policeStation": IncidentPoliceStation,
                "address": IncidentAddress,
                //"incidentDate": IncidentDate,
                //"incidentTime": IncidentTime,
                //"incidentTimeEnd": IncidentTimeEnd,
                "incidentDate": "2022-04-01T07:13:36.415Z",
                "incidentTime": "2022-04-01T07:13:36.415Z",
                "incidentTimeEnd": "2022-04-01T07:13:36.415Z",
                "latitude": IncidentLatitude,
                "longitude": IncidentLongitude,
                "NumberKilled":numberKilled,
                "NumberInjured": numberInjured,
                "InjuredName": InjuredName,
                "CasualtiesNames": KilledNames,
                "Weapon": weapon,
                "Target": Target,
                "Motive": Motive,
                "Recoveries": Recoveries,
                "CrimeSceneRecoveries": crimeSceneRecoveries,
                "CaseStatus": caseStatus,
                "NumberArrested": NumberArrested,
                "Reportedby": Reportedby,
                "strCaseProgress": CaseProgress,
                "CTWRemarks": CTWRemarks,
                "createdBy": "admin",
                "UpdatedBy": "admin",
                  "IsDeleted":false
              }), 
            };
            $.ajax(settings).done(function (response) {
              console.log(response);
              alert("Incident has been updated Successfully");
    
               var id=response.strURN;
               localStorage.setItem("strURN", response.strURN);
               localStorage.setItem("tableName", "Incident");
                 window.location.href = "/Admin/Records/PreviewRecord?controller=Incidents&id="+id;
        
              // window.location.href = "/Admin/Records/PreviewIncidentRecord?id="+stdId;
              });
         }

    function LoadReportingAgency()
    {
      var ReportingAgencyList = $('#Reportedby');
     
        try {
        $.ajax({
            url: '/api/ReportingAgencies',
              method: 'Get',
            //headers: {
              //  'Content-Type': 'application/x-www-form-urlencoded'
            //},
            dataType: 'json',
           
            success: function ( data) {
                $('#Reportedby').empty();
           var v = JSON.stringify(data);
             var selIncAgency = "";
              selIncAgency += "<option value='' disabled selected>--Select--</option>";
              $.each(data, function (k, v) {
                   var id1  = data[k].reportingAgencyTitle;
                  // var val1 =  JSON.stringify(data[k].ReportingAgencyTitle);
                   selIncAgency += "<option value='" + id1 + "'>" + id1 + "</option>";
                    });
                     ReportingAgencyList.append(selIncAgency); 
              
              },
            error: function (request, status, error) {
           
             //   alert("Error.");
            }
        });
    }
    catch (err) {
        exceptionHandeld(err)
    }
    }
     function LoadIncidentCountry()
    {
      var IncidentCountries = $('#IncidentCountryList');
   
     
        try {
        $.ajax({
            url: '/api/Countries',
              method: 'Get',
            //headers: {
              //  'Content-Type': 'application/x-www-form-urlencoded'
            //},
            dataType: 'json',
           
            success: function ( data) {

           var v = JSON.stringify(data);
             var selOpts = "";
             selOpts += "<option value='' disabled selected>--Select--</option>";
              $.each(data, function (k, v) {
                   var id = data[k].strCountry;
                   var val = data[k].strCountry;
                   selOpts += "<option value='" + id + "'>" + val + "</option>";
                    });
                     IncidentCountries.append(selOpts); 
                    

},
            error: function (request, status, error) {
           
                alert("Error.");
            }
        });
    }
    catch (err) {
        exceptionHandeld(err)
    }
    }
     function LoadIncidentProvince()
    {
        var IncidentProvinces = $('#IncidentProvinceList');   
      
       try {
        $.ajax({
            url: '/api/ProvinceLists',
              method: 'Get',
            //headers: {
              //  'Content-Type': 'application/x-www-form-urlencoded'
            //},
            dataType: 'json',
            beforeSend: function () {

                //$("#loader").show();
            },
            complete: function () {

                //$("#loader").hide();
            },
            success: function ( data) {
                ProvinceList = data;
                  $('#IncidentProvinceList').empty();
                 console.log(ProvinceList);
           var v = JSON.stringify(data);
        //   alert(JSON.stringify(data));
             var selOptsProvince = "";
             selOptsProvince += "<option value='' disabled selected>--Select--</option>";
              $.each(data, function (k, v) {
                   var id = data[k].strProvince;
                   var val = data[k].strProvince;
                   selOptsProvince += "<option value='" + id + "'>" + val + "</option>";
                    });
                   IncidentProvinces.append(selOptsProvince);
             },
            error: function (request, status, error) {
           
              //  alert("Error.");
            }
        });
    }
    catch (err) {
        exceptionHandeld(err)
    }
    }

      function LoadDistrict()
    {
        
         var IncidentProv = $('#IncidentProvinceList').val();   
         var IncidentDistrictList = $('#IncidentDistrictList'); 
       try {
        $.ajax({
            url: '/api/DistrictList/SearchDis?pro='+IncidentProv,
            method: 'Post',
            dataType: 'json',
            success: function ( data) {
              $('#IncidentDistrictList').empty();
              var v = JSON.stringify(data);
              var selOptsDis = "";
               selOptsDis += "<option value='' disabled selected>--Select--</option>";
                  $.each(data, function (k, v) {
                       var id = data[k].strDistrict;
                       var val = data[k].strDistrict;
                       selOptsDis += "<option value='" + id + "'>" + val + "</option>";
                        });
                       IncidentDistrictList.append(selOptsDis);
                 },
            error: function (request, status, error) {
             // alert("Error.");
            }
           });
        }  
        catch (err) {
            exceptionHandeld(err)
        }
  
    }
        function LoadCity()
    {
        selectdistrict();
         var DistrictValue= $('#IncidentDistrictList').val();   
         var IncidentCity = $('#IncidentCity'); 
       try {
        $.ajax({
            url: '/api/CityList/SearchCity?pro='+DistrictValue,
            method: 'Post',
            dataType: 'json',
            success: function ( data) {
              $('#IncidentCity').empty();
              var v = JSON.stringify(data);
              var selOptsCity = "";
               selOptsCity += "<option value='' disabled selected>--Select--</option>";
                  $.each(data, function (k, v) {
                       var id = data[k].strCity;
                       var val = data[k].strCity;
                       selOptsCity += "<option value='" + id + "'>" + val + "</option>";
                        });
                       IncidentCity.append(selOptsCity);
                 },
            error: function (request, status, error) {
           //   alert("Error.");
            }
           });
        }  
        catch (err) {
            exceptionHandeld(err)
        }
  
    }
    
        
     function ViewIncidentById(param_x)
     {
            var url = "/api/Incidents/GetIncidentById?id="+param_x;
            $.ajax({  
            type: "GET",  
            url: url,
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            success: function (response) {  
             // alert(JSON.stringify(response));
             
                     $("#OperationName").val(response.strOperationName);
                     $("#FirNo").val(response.firNo);
                     $("#RegYear").val(response.regYear);
                     $("#US").val(response.us);
                     $("#IncidentProvinceList").val(response.province);
                      LoadDistrict();
                     $("#IncidentDistrictList").val(response.district);
                   $("#IncidentPostalZip").val(response.postalZip);
                   
                     $("#IncidentAddress").val(response.address)  ;
                           
                      LoadCity();
                      $("#InjuredName").val(response.injuredName);
                     $("#KilledNames").val(response.casualtiesNames);
                     $("#Motive").val(response.motive);
                      $("#IncidentCity").val(response.city);
                      $("#PreIncidentThread").val(response.preIncidentThread);
                      $("#NumberKilled").val(response.numberKilled);
                      LoadPolice();
                      $("#Weapon").val(response.weapon);
                     $("#IncidentTarget").val(response.target);
                     $("#Recoveries").val(response.recoveries);
                     $("#Reportedby").val(response.reportedby);
                     $("#NumberInjured").val(response.numberInjured);
                      $("#PoliceStation").val(response.policeStation);
                    $("#CaseStatus").val(response.caseStatus);
                      $("#CaseProgress").val(response.caseProgress);
                     $("#PreIncidentThread").val(response.preIncidentThread);
                     
                     $("#IncidentmemRemarks").val(response.memRemarks);                   
                       $("#ModusofOperandiId").val(response.modusofOperandi); 
                     $("#IncidentLatitude").val(response.latitude);  
                     $("#IncidentLongitude").val(response.longitude);
                     
                   
                  

            },
            error: function (response) {  
             //   alert("error");  
            }
        });         
            
  }
  $("#selectedcountry").change(function () {
         //alert("sadasd");
       var conceptName = $('#selectedcountry').find(":selected").text();
       LoadCountryProvince(conceptName);
    });
    $("#personprovince").change(function () {
        var pn = $('#personprovince').find(":selected").text();
        getDistrictlist(pn);
    });
    function LoadCountryProvince(country)
    {
      
         $("#personprovince option").remove();
        $("#SelectDistrict option").remove();
        var personprovince = $('#personprovince');
        $.ajax({
            url: '/AllRcord/getProvinceList'
        , type: 'GET'
        , data: {country:country}
        , contentType: 'application/json'
        , success: function (response) {
         
                 var Prlist = "";
                 Prlist="<option>Select Province</option>";
                for (var m = 0; m < response.length; m++) {
                     Prlist += "<option value='" + response[m] + "'>" + response[m] + "</option>";
                    
                }
                personprovince.append(Prlist);
         
        }
    });
    }
    function LoadPolice()
        {
             var pn = $('#SelectDistrict').find(":selected").text();
           var Pl=  policeStationlis=$('#PoliceStation');
        $.ajax({
            url: '/AllRcord/getPoliceStation'
        , type: 'GET'
        , data: {District:pn}
        , contentType: 'application/json'
        , success: function (response) {
         
                 var Dslist = "";
               Dslist=null;

                for (var d = 0; d < response.length; d++) {
                     Dslist += "<option value='" + response[d] + "'>" + response[d] + "</option>";
                    
                }
                Pl.append(Dslist);
         
        }
    });
        }
    function getDistrictlist(Province)
    {
     
        $("#SelectDistrict option").remove();

        var Districlist = $('#SelectDistrict');
        $.ajax({
            url: '/AllRcord/getDistrictlist'
        , type: 'GET'
        , data: {Province:Province}
        , contentType: 'application/json'
        , success: function (response) {
         
                 var Dslist = "<option>Select District</option>";
               

                for (var d = 0; d < response.length; d++) {
                     Dslist += "<option value='" + response[d] + "'>" + response[d] + "</option>";
                    
                }
                Districlist.append(Dslist);
         
        }
    });
    }
    
    // function LoadDistrict()
    //{
    //     var IncidentProvinces = $('#IncidentProvinceList').val();   
    //     var IncidentDistrictList = $('#IncidentDistrictList'); 
      
                
    //         var selOptsDes = "";
    //         selOptsDes += "<option value='' disabled selected>--Select--</option>";
    //           var jsonObject = $.parseJSON(ProvinceList);
    //            $.each(jsonObject, function (i, propVal) {
                  
    //                var dbdisTable  = dbList.filter(function(v) {
    //                return v.strProvince == IncidentProvinces; // Filter out the appropriate one
    //                })[0].strDistrict;
             
    //               IncidentDistrictList.append(dbdisTable);
    //         },
    //        error: function (request, status, error) {
           
    //            alert("Error.");
    //        }
    //    });
    //}
    //catch (err) {
    //    exceptionHandeld(err)
    //}
    //}
     </script>
  
